<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Color Wheel - Minecraft Atlas</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">
  <link rel="shortcut icon" href="./max.jpg" type="image/x-icon">
  <style>
    :root {
      --primary: #00c6ff;
      --primary-dark: #0072ff;
      --primary-light: #70e1ff;
      --accent: #ff7eb3;
      --accent-dark: #ff4d96;
      --success: #4ade80;
      --warning: #fbbf24;
      --error: #f87171;
      --text-primary: #ffffff;
      --text-secondary: #bbbbbb;
      --text-tertiary: #777777;
      --surface-1: #121212;
      --surface-2: #1f1f1f;
      --surface-3: #2c2c2c;
      --surface-4: #373737;
      --border: #2c2c2c;
      --hover-effect: rgba(255, 255, 255, 0.05);
      --glass-blur: blur(10px);
      --space-xs: 0.25rem;
      --space-sm: 0.5rem;
      --space-md: 1rem;
      --space-lg: 2rem;
      --space-xl: 3rem;
      --radius-sm: 6px;
      --radius-md: 12px;
      --radius-lg: 20px;
      --radius-full: 999px;
      --transition-fast: all 0.3s ease;
      --transition-medium: all 0.5s ease;
      --shadow-sm: 0 2px 4px rgba(0,0,0,0.3);
      --shadow-md: 0 4px 12px rgba(0,0,0,0.4);
      --shadow-lg: 0 10px 30px rgba(0,0,0,0.5);
    }

    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }

    body {
      background-color: var(--surface-1);
      color: var(--text-primary);
      font-family: 'Inter', sans-serif;
      display: flex;
      flex-direction: column;
      min-height: 100vh;
      overflow-x: hidden;
      background-image: radial-gradient(circle at 10% 20%, rgba(0, 118, 255, 0.05) 0%, transparent 45%),
                        radial-gradient(circle at 80% 70%, rgba(255, 126, 179, 0.05) 0%, transparent 45%);
    }

    a {
      text-decoration: none;
      color: inherit;
    }

    /* HEADER - AMÉLIORÉ */
    header {
      padding: var(--space-xl) var(--space-lg);
      text-align: center;
      position: relative;
      overflow: hidden;
    }

    header::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: radial-gradient(ellipse at top, rgba(0, 198, 255, 0.1), transparent 70%),
                  radial-gradient(ellipse at bottom, rgba(255, 126, 179, 0.1), transparent 70%);
      z-index: -1;
    }

    header h1 {
      font-size: 3.2rem;
      font-weight: 800;
      margin-bottom: var(--space-md);
      background: linear-gradient(120deg, var(--primary), var(--accent));
      -webkit-background-clip: text;
      background-clip: text;
      -webkit-text-fill-color: transparent;
      position: relative;
      display: inline-block;
    }

    header h1 i {
      font-size: 2.8rem;
      margin-right: var(--space-md);
      background: linear-gradient(120deg, var(--primary-light), var(--primary));
      -webkit-background-clip: text;
      background-clip: text;
      -webkit-text-fill-color: transparent;
    }

    header h1::after {
      content: '';
      position: absolute;
      bottom: -10px;
      left: 25%;
      width: 50%;
      height: 4px;
      background: linear-gradient(90deg, transparent, var(--primary), transparent);
      border-radius: var(--radius-full);
    }

    header p {
      font-size: 1.2rem;
      color: var(--text-secondary);
      max-width: 700px;
      margin: 0 auto;
      line-height: 1.6;
    }

    /* MAIN CONTENT - REDESIGN COMPLET */
    main {
      flex: 1;
      max-width: 1400px;
      margin: 0 auto;
      padding: var(--space-lg);
      display: grid;
      grid-template-columns: 380px 1fr;
      gap: var(--space-xl);
      width: 100%;
    }

    /* COLORWHEEL SECTION - TOTALEMENT REDESIGNÉ */
    #colorwheel-container {
      background: linear-gradient(145deg, var(--surface-2), var(--surface-3));
      border-radius: var(--radius-lg);
      padding: var(--space-xl) var(--space-lg);
      display: flex;
      flex-direction: column;
      align-items: center;
      box-shadow: var(--shadow-lg),
                  inset 0 1px 1px rgba(255, 255, 255, 0.05);
      position: relative;
      overflow: hidden;
      height: fit-content;
    }

    .section-title {
      position: absolute;
      top: -5px;
      left: 24px;
      background: linear-gradient(90deg, var(--primary-dark), var(--primary));
      padding: 6px 16px;
      border-radius: var(--radius-full);
      font-size: 14px;
      font-weight: 600;
      color: #fff;
      letter-spacing: 0.5px;
      box-shadow: var(--shadow-sm);
    }

    #colorwheel-container::after {
      content: "";
      position: absolute;
      width: 150%;
      height: 150%;
      top: -25%;
      left: -25%;
      background: radial-gradient(circle, transparent 30%, var(--surface-2) 70%);
      opacity: 0.4;
      z-index: 0;
      animation: rotate 20s linear infinite;
    }

    @keyframes rotate {
      0% { transform: rotate(0deg); }
      100% { transform: rotate(360deg); }
    }

    .wheel-wrapper {
      position: relative;
      z-index: 2;
      width: 280px;
      height: 280px;
      border-radius: 50%;
      margin: var(--space-md) 0 var(--space-lg);
      padding: 8px;
      background: linear-gradient(145deg, var(--surface-3), var(--surface-4));
      box-shadow: var(--shadow-md),
                  inset 0 1px 3px rgba(255, 255, 255, 0.05);
    }

    #colorwheel {
      width: 100%;
      height: 100%;
      border: none;
      border-radius: 50%;
      background-color: transparent;
      cursor: pointer;
      overflow: hidden;
      box-shadow: inset 0 4px 12px rgba(0, 0, 0, 0.5);
      transition: var(--transition-medium);
      position: relative;
      z-index: 1;
    }

    #colorwheel::-webkit-color-swatch-wrapper {
      padding: 0;
      border-radius: 50%;
    }

    #colorwheel::-webkit-color-swatch {
      border: none;
      border-radius: 50%;
      box-shadow: inset 0 0 0 8px rgba(255, 255, 255, 0.1);
    }

    #colorwheel::-moz-color-swatch {
      border: none;
      border-radius: 50%;
    }

    #colorwheel:hover {
      transform: scale(1.03);
      box-shadow: 0 0 30px rgba(var(--primary-rgb), 0.3),
                  inset 0 4px 12px rgba(0, 0, 0, 0.5);
    }

    .color-info {
      width: 100%;
      margin-top: var(--space-lg);
      position: relative;
      z-index: 2;
    }

    .selected-color {
      display: flex;
      align-items: center;
      gap: var(--space-md);
      padding: var(--space-md);
      background: var(--surface-2);
      border-radius: var(--radius-md);
      margin-bottom: var(--space-md);
      box-shadow: var(--shadow-sm);
      border: 1px solid var(--border);
    }

    .color-preview {
      width: 48px;
      height: 48px;
      border-radius: var(--radius-sm);
      box-shadow: inset 0 2px 4px rgba(0, 0, 0, 0.3);
      border: 1px solid rgba(255, 255, 255, 0.1);
    }

    .color-values {
      flex: 1;
    }

    .color-code {
      font-family: 'Consolas', monospace;
      font-size: 1.1rem;
      color: var(--text-primary);
      margin-bottom: 4px;
    }

    .color-rgb {
      font-size: 0.8rem;
      color: var(--text-tertiary);
    }

    .tips {
      background: rgba(0, 198, 255, 0.1);
      border-left: 3px solid var(--primary);
      padding: var(--space-md);
      border-radius: var(--radius-sm);
      font-size: 0.9rem;
      line-height: 1.5;
      color: var(--text-secondary);
      margin-top: var(--space-lg);
    }

    .tips strong {
      color: var(--primary);
    }

    /* RÉSULTATS SECTION - TOTALEMENT REDESIGNÉ */
    #result-container {
      background: var(--surface-2);
      border-radius: var(--radius-lg);
      padding: var(--space-xl) var(--space-lg);
      position: relative;
      box-shadow: var(--shadow-md);
      border: 1px solid var(--border);
      height: fit-content;
      min-height: 500px;
    }

    .result-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: var(--space-lg);
    }

    #result-container h2 {
      font-size: 1.6rem;
      font-weight: 700;
      position: relative;
      padding-bottom: var(--space-sm);
      color: var(--text-primary);
      margin: 0;
    }

    #result-container h2::after {
      content: '';
      position: absolute;
      bottom: 0;
      left: 0;
      width: 60px;
      height: 3px;
      background: linear-gradient(90deg, var(--primary), transparent);
      border-radius: var(--radius-full);
    }

    .block-count {
      background: var(--surface-3);
      padding: var(--space-xs) var(--space-md);
      border-radius: var(--radius-full);
      font-size: 0.85rem;
      color: var(--text-secondary);
    }

    .filters {
      display: flex;
      justify-content: space-between;
      margin-bottom: var(--space-lg);
      gap: var(--space-md);
    }

    .search-box {
      flex: 1;
      position: relative;
    }

    .search-box input {
      width: 100%;
      padding: var(--space-sm) var(--space-md) var(--space-sm) var(--space-xl);
      background: var(--surface-3);
      border: 1px solid var(--border);
      border-radius: var(--radius-md);
      color: var(--text-primary);
      font-size: 0.9rem;
      outline: none;
      transition: var(--transition-fast);
    }

    .search-box input:focus {
      border-color: var(--primary);
      box-shadow: 0 0 0 2px rgba(0, 198, 255, 0.2);
    }

    .search-box i {
      position: absolute;
      left: var(--space-md);
      top: 50%;
      transform: translateY(-50%);
      color: var(--text-tertiary);
    }

    .sort-options {
      display: flex;
      gap: var(--space-xs);
    }

    .sort-btn {
      padding: var(--space-sm) var(--space-md);
      background: var(--surface-3);
      border: 1px solid var(--border);
      border-radius: var(--radius-md);
      color: var(--text-secondary);
      cursor: pointer;
      transition: var(--transition-fast);
      display: flex;
      align-items: center;
      gap: var(--space-xs);
      font-size: 0.9rem;
    }

    .sort-btn:hover, .sort-btn.active {
      background: var(--surface-4);
      color: var(--text-primary);
      border-color: var(--primary-dark);
    }

    .sort-btn i {
      font-size: 0.8rem;
    }

    .block-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(120px, 1fr));
      gap: var(--space-md);
    }

    .block-item {
      background: linear-gradient(145deg, var(--surface-3), var(--surface-2));
      border-radius: var(--radius-md);
      padding: var(--space-md);
      text-align: center;
      box-shadow: var(--shadow-sm), 
                  inset 0 1px 1px rgba(255, 255, 255, 0.02);
      transition: var(--transition-fast);
      cursor: pointer;
      position: relative;
      overflow: hidden;
      border: 1px solid var(--border);
    }

    .block-item::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 2px;
      background: linear-gradient(90deg, transparent, rgba(0, 198, 255, 0.3), transparent);
      transform: translateX(-100%);
      transition: transform 0.6s ease;
    }

    .block-item:hover {
      transform: translateY(-5px);
      box-shadow: var(--shadow-md), 
                  0 0 15px rgba(var(--primary-rgb), 0.15),
                  inset 0 1px 1px rgba(255, 255, 255, 0.05);
      border-color: rgba(0, 198, 255, 0.3);
    }

    .block-item:hover::before {
      transform: translateX(100%);
    }

    .block-img-wrapper {
      width: 64px;
      height: 64px;
      margin: 0 auto var(--space-sm);
      position: relative;
    }

    .block-item img {
      width: 100%;
      height: 100%;
      object-fit: contain;
      image-rendering: pixelated;
      transition: var(--transition-fast);
      filter: drop-shadow(0 4px 6px rgba(0,0,0,0.4));
    }

    .block-item:hover img {
      transform: scale(1.1) translateY(-5px);
    }

    .block-info {
      display: flex;
      flex-direction: column;
      gap: 4px;
    }

    .block-name {
      font-size: 0.85rem;
      color: var(--text-primary);
      font-weight: 500;
      transition: var(--transition-fast);
      overflow: hidden;
      text-overflow: ellipsis;
      white-space: nowrap;
    }

    .color-match {
      font-size: 0.75rem;
      color: var(--accent);
      font-weight: 600;
    }

    .color-tag {
      display: inline-block;
      width: 14px;
      height: 14px;
      border-radius: 50%;
      margin-right: 4px;
      vertical-align: middle;
      border: 1px solid rgba(255, 255, 255, 0.1);
    }

    /* No-results message */
    .no-results {
      text-align: center;
      padding: var(--space-xl) 0;
      color: var(--text-secondary);
    }

    .no-results i {
      font-size: 3rem;
      margin-bottom: var(--space-md);
      opacity: 0.3;
    }

    .no-results h3 {
      margin-bottom: var(--space-md);
      font-size: 1.4rem;
    }

    .no-results p {
      max-width: 400px;
      margin: 0 auto;
      font-size: 0.9rem;
      line-height: 1.6;
    }

    /* Scrollbar */
    ::-webkit-scrollbar {
      width: 8px;
    }

    ::-webkit-scrollbar-track {
      background: var(--surface-1);
    }

    ::-webkit-scrollbar-thumb {
      background: var(--border);
      border-radius: var(--radius-full);
    }

    ::-webkit-scrollbar-thumb:hover {
      background: var(--primary-dark);
    }

    /* Media Queries */
    @media (max-width: 1100px) {
      main {
        grid-template-columns: 1fr;
        gap: var(--space-md);
      }
      
      #colorwheel-container {
        max-width: 600px;
        margin: 0 auto;
      }
      
      .color-info {
        display: flex;
        gap: var(--space-md);
      }
      
      .selected-color {
        flex: 1;
        margin-bottom: 0;
      }
      
      .tips {
        flex: 1;
        margin-top: 0;
      }
    }

    @media (max-width: 768px) {
      header h1 {
        font-size: 2.5rem;
      }
      
      .color-info {
        flex-direction: column;
      }
      
      .filters {
        flex-direction: column;
      }
      
      .block-grid {
        grid-template-columns: repeat(auto-fill, minmax(100px, 1fr));
      }
      
      .nav-container {
        flex-direction: column;
        gap: var(--space-md);
        padding: var(--space-md);
      }
      
      .nav-links {
        width: 100%;
        justify-content: center;
        flex-wrap: wrap;
      }
    }

    @media (max-width: 480px) {
      .block-grid {
        grid-template-columns: repeat(auto-fill, minmax(80px, 1fr));
      }
      
      header {
        padding: var(--space-lg) var(--space-md);
      }
      
      header h1 {
        font-size: 2rem;
      }
      
      .wheel-wrapper {
        width: 220px;
        height: 220px;
      }
    }

/* Important : pour éviter conflits avec d'autres media queries */
.main-nav {
  position: relative; /* important */
  z-index: 100;
}

.menu-toggle {
      position: fixed;
      top: 20px;
      right: 20px;
      z-index: 1001;
      background: none;
      border: none;
      cursor: pointer;
    }

    .menu-toggle .bar {
      width: 30px;
      height: 4px;
      background-color: white;
      margin: 5px 0;
      border-radius: 2px;
      transition: all var(--transition-fast);
    }

    .menu-overlay {
      position: fixed;
      top: 0;
      left: 0;
      width: 100vw;
      height: 100vh;
      background: rgba(0, 0, 0, 0.85);
      backdrop-filter: var(--glass-blur);
      z-index: 1000;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      transform: translateY(-100%);
      transition: transform var(--transition-fast);
    }

    .menu-overlay.show {
      transform: translateY(0);
    }

    .menu-link {
      font-size: 1.8rem;
      margin: 20px 0;
      color: var(--text-primary);
      text-decoration: none;
      transition: color var(--transition-fast);
    }

    .menu-link:hover {
      color: var(--accent);
    }

  </style>
</head>
<body>
  <button class="menu-toggle" id="menu-toggle" aria-label="Menu">
    <div class="bar"></div>
    <div class="bar"></div>
    <div class="bar"></div>
  </button>

  <div class="menu-overlay" id="menu-overlay">
    <a href="index.html" class="menu-link">Textures</a>
    <a href="palette.html" class="menu-link">Palettes</a>
    <a href="community-palette.html" class="menu-link">Communauté-Palettes</a>
    <a href="colorwheel.html" class="menu-link">ColorWheel</a>
    <a href="blockgradient.html" class="menu-link">BlockGradient</a>
    <a href="patterncraft.html" class="menu-link">PatternCraft</a>
    <a href="pixelmapper.html" class="menu-link">PixelMapper</a>
    <a href="wiki.html" class="menu-link">Wiki</a>
    <a href="blueprint.html" class="menu-link">BlueprintCraft</a>
  </div>

  <script>
    const menuToggle = document.getElementById('menu-toggle');
    const menuOverlay = document.getElementById('menu-overlay');

    menuToggle.addEventListener('click', () => {
      menuOverlay.classList.toggle('show');
    });
  </script>

  <header>
    <h1><i class="fas fa-globe"></i> Color Wheel</h1>
    <p>Explore les combinaisons de blocs Minecraft proches de n'importe quelle couleur pour créer des palettes harmonieuses</p>
  </header>

  <main>
    <div id="colorwheel-container">
      <div class="section-title">Sélecteur de couleur</div>
      <div class="wheel-wrapper">
        <input type="color" id="colorwheel" title="Choisissez une couleur" value="#4287f5" />
      </div>
      
      <div class="color-info">
        <div class="selected-color">
          <div class="color-preview" id="color-preview" style="background-color: #4287f5;"></div>
          <div class="color-values">
            <div class="color-code" id="color-hex">#4287f5</div>
            <div class="color-rgb" id="color-rgb">RGB: 66, 135, 245</div>
          </div>
        </div>
        
        <div class="tips">
          <strong>Astuce :</strong> Sélectionnez une couleur pour trouver automatiquement les blocs Minecraft qui s'en rapprochent le plus. Idéal pour créer des palettes cohérentes pour vos constructions !
        </div>
      </div>
    </div>

    <div id="result-container">
      <div class="result-header">
        <h2>Blocs correspondants</h2>
        <div class="block-count" id="block-count">20 blocs trouvés</div>
      </div>
      
      <div class="filters">
        <div class="search-box">
          <i class="fas fa-search"></i>
          <input type="text" placeholder="Filtrer par nom..." id="search-blocks">
        </div>
        
        <div class="sort-options">
          <button class="sort-btn active" data-sort="match">
            <i class="fas fa-sort-amount-down"></i> Similitude
          </button>
          <button class="sort-btn" data-sort="name">
            <i class="fas fa-sort-alpha-down"></i> Nom
          </button>
        </div>
      </div>
      
      <div class="block-grid" id="blocks-grid">
        <!-- Contenu généré dynamiquement par JavaScript -->
      </div>
      
      <!-- Message d'absence de résultats (masqué par défaut) -->
      <div class="no-results" id="no-results" style="display: none;">
        <i class="fas fa-search"></i>
        <h3>Aucun bloc trouvé</h3>
        <p>Essayez de sélectionner une autre couleur ou de modifier vos critères de recherche.</p>
      </div>
    </div>
  </main>

  <script>
    // Code JavaScript amélioré
    const colorWheel = document.getElementById("colorwheel");
    const colorPreview = document.getElementById("color-preview");
    const colorHex = document.getElementById("color-hex");
    const colorRgb = document.getElementById("color-rgb");
    const blocksGrid = document.getElementById("blocks-grid");
    const blockCount = document.getElementById("block-count");
    const noResults = document.getElementById("no-results");
    const searchInput = document.getElementById("search-blocks");
    const sortBtns = document.querySelectorAll(".sort-btn");
    
    function hexToRgb(hex) {
      const bigint = parseInt(hex.slice(1), 16);
      return {
        r: (bigint >> 16) & 255,
        g: (bigint >> 8) & 255,
        b: bigint & 255
      };
    }
    
    function rgbDistance(c1, c2) {
      return Math.sqrt(
        Math.pow(c1.r - c2.r, 2) +
        Math.pow(c1.g - c2.g, 2) +
        Math.pow(c1.b - c2.b, 2)
      );
    }
    
    let textureData = [];
    let filteredBlocks = [];
    let currentColor = colorWheel.value;
    let currentSort = "match";
    let searchTerm = "";
    
    async function loadTextures() {
      try {
        const res = await fetch('texture-data.json');
        const data = await res.json();
        textureData = data.map(item => {
          return {
            ...item,
            avgColor: {
              r: item.rgb[0],
              g: item.rgb[1],
              b: item.rgb[2]
            },
            path: `blocks/${item.name}.png`,
            filename: item.name,
            displayName: item.name.replace(/_/g, ' ').replace(/\b\w/g, l => l.toUpperCase())
          };
        });
        
        updateResults();
      } catch (error) {
        console.error("Erreur lors du chargement des textures:", error);
        noResults.style.display = "block";
        blocksGrid.style.display = "none";
      }
    }
    
    function updateColorDisplay() {
      const hexColor = colorWheel.value;
      const rgbColor = hexToRgb(hexColor);
      
      colorPreview.style.backgroundColor = hexColor;
      colorHex.textContent = hexColor.toUpperCase();
      colorRgb.textContent = `RGB: ${rgbColor.r}, ${rgbColor.g}, ${rgbColor.b}`;
      
      currentColor = hexColor;
      updateResults();
    }
    
    function updateResults() {
      if (!textureData.length) return;
      
      const selectedRgb = hexToRgb(currentColor);
      
      // Calculer les distances et filtrer
      filteredBlocks = textureData
        .map(block => {
          const distance = rgbDistance(selectedRgb, block.avgColor);
          return { ...block, distance };
        })
        .filter(block => {
          if (!searchTerm) return true;
          return block.displayName.toLowerCase().includes(searchTerm.toLowerCase());
        })
        .sort((a, b) => {
          if (currentSort === "match") {
            return a.distance - b.distance;
          } else {
            return a.displayName.localeCompare(b.displayName);
          }
        })
        .slice(0, 50); // Limiter aux 50 meilleurs résultats
      
      renderBlocks();
    }
    
    function renderBlocks() {
      blocksGrid.innerHTML = "";
      
      if (filteredBlocks.length === 0) {
        noResults.style.display = "block";
        blockCount.textContent = "0 bloc trouvé";
        return;
      }
      
      noResults.style.display = "none";
      blockCount.textContent = `${filteredBlocks.length} blocs trouvés`;
      
      filteredBlocks.forEach(block => {
        const blockEl = document.createElement("div");
        blockEl.className = "block-item";
        
        const matchPercentage = Math.max(0, 100 - Math.round(block.distance * 100 / 442)).toFixed(0);
        
        blockEl.innerHTML = `
          <div class="block-img-wrapper">
            <img src="${block.path}" alt="${block.displayName}" loading="lazy">
          </div>
          <div class="block-info">
            <div class="block-name">${block.displayName}</div>
            <div class="color-match">
              <span class="color-tag" style="background-color: ${block.color}"></span>
              ${matchPercentage}% match
            </div>
          </div>
        `;
        
        blocksGrid.appendChild(blockEl);
      });
    }
    
    // Event Listeners
    colorWheel.addEventListener("input", updateColorDisplay);
    colorWheel.addEventListener("change", updateColorDisplay);
    
    searchInput.addEventListener("input", (e) => {
      searchTerm = e.target.value;
      updateResults();
    });
    
    sortBtns.forEach(btn => {
      btn.addEventListener("click", () => {
        sortBtns.forEach(b => b.classList.remove("active"));
        btn.classList.add("active");
        currentSort = btn.dataset.sort;
        updateResults();
      });
    });
    
    // Initialisation
    loadTextures();
    updateColorDisplay();
  </script>
</body>
</html>
